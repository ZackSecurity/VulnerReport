# A file upload vulnerability exists in the background

### 1.Environment construction

Built with PHPStudy2014 (Nginx+PHP5.3) and Ray CMS1.5.
Download from http://www.gxcms.org/
[![image](https://private-user-images.githubusercontent.com/34084717/290613781-3fc127fa-d0bd-4142-ab41-1baf6f7913fd.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MTE0NDY5MzIsIm5iZiI6MTcxMTQ0NjYzMiwicGF0aCI6Ii8zNDA4NDcxNy8yOTA2MTM3ODEtM2ZjMTI3ZmEtZDBiZC00MTQyLWFiNDEtMWJhZjZmNzkxM2ZkLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDAzMjYlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwMzI2VDA5NTAzMlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTMzNzFmNTg4YzcxY2YwMTkwNzgxZjE2YzQzMDkxNGYwYjI0NDRhNjEzNjg3ODY1ODk4ZmYzMDg5YTdiOWQ0OGYmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.Lrcvi075ctQhq9NtmrJ5OmTdMZESwXWilpLjNPQALVI)](https://private-user-images.githubusercontent.com/34084717/290613781-3fc127fa-d0bd-4142-ab41-1baf6f7913fd.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MTE0NDY5MzIsIm5iZiI6MTcxMTQ0NjYzMiwicGF0aCI6Ii8zNDA4NDcxNy8yOTA2MTM3ODEtM2ZjMTI3ZmEtZDBiZC00MTQyLWFiNDEtMWJhZjZmNzkxM2ZkLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDAzMjYlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwMzI2VDA5NTAzMlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTMzNzFmNTg4YzcxY2YwMTkwNzgxZjE2YzQzMDkxNGYwYjI0NDRhNjEzNjg3ODY1ODk4ZmYzMDg5YTdiOWQ0OGYmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.Lrcvi075ctQhq9NtmrJ5OmTdMZESwXWilpLjNPQALVI)
Put the website source code into the website root directory, access the address installation:
[![image](https://private-user-images.githubusercontent.com/34084717/290613869-f6e3a180-4024-4e19-a9c5-2cfdd39d4c34.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MTE0NDY5MzIsIm5iZiI6MTcxMTQ0NjYzMiwicGF0aCI6Ii8zNDA4NDcxNy8yOTA2MTM4NjktZjZlM2ExODAtNDAyNC00ZTE5LWE5YzUtMmNmZGQzOWQ0YzM0LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDAzMjYlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwMzI2VDA5NTAzMlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTZmMGM1ZDgyN2Q2MWIzNWFmNjAyMWY0Zjc2NTk4OTdhNDliNzEwZjIxYWQ3OWNmMTA1OWQ2N2VlY2ZjZjhkNWImWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.bqDo_Hb7ZSBMa2Vtcp4dCSKqdn8NP7_2ctAvf1ABJJk)](https://private-user-images.githubusercontent.com/34084717/290613869-f6e3a180-4024-4e19-a9c5-2cfdd39d4c34.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MTE0NDY5MzIsIm5iZiI6MTcxMTQ0NjYzMiwicGF0aCI6Ii8zNDA4NDcxNy8yOTA2MTM4NjktZjZlM2ExODAtNDAyNC00ZTE5LWE5YzUtMmNmZGQzOWQ0YzM0LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDAzMjYlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwMzI2VDA5NTAzMlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTZmMGM1ZDgyN2Q2MWIzNWFmNjAyMWY0Zjc2NTk4OTdhNDliNzEwZjIxYWQ3OWNmMTA1OWQ2N2VlY2ZjZjhkNWImWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.bqDo_Hb7ZSBMa2Vtcp4dCSKqdn8NP7_2ctAvf1ABJJk)
[![image](https://private-user-images.githubusercontent.com/34084717/290613896-bd7e81cf-0b17-480a-b3f1-9eca85cb0e2d.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MTE0NDY5MzIsIm5iZiI6MTcxMTQ0NjYzMiwicGF0aCI6Ii8zNDA4NDcxNy8yOTA2MTM4OTYtYmQ3ZTgxY2YtMGIxNy00ODBhLWIzZjEtOWVjYTg1Y2IwZTJkLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDAzMjYlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwMzI2VDA5NTAzMlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWVkNmIzNGY0ZTczMWFiMjIzN2ZiMjMxMTRjNzhkNGRmODEwODExZjU3MzY5M2NjNjY1MWE3YWQ1YWQ5OGE1NzgmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.WAA_hEOgMQygDBYtfeFGhr2eX3NqhWbsOcKR5DdGW80)](https://private-user-images.githubusercontent.com/34084717/290613896-bd7e81cf-0b17-480a-b3f1-9eca85cb0e2d.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MTE0NDY5MzIsIm5iZiI6MTcxMTQ0NjYzMiwicGF0aCI6Ii8zNDA4NDcxNy8yOTA2MTM4OTYtYmQ3ZTgxY2YtMGIxNy00ODBhLWIzZjEtOWVjYTg1Y2IwZTJkLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDAzMjYlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwMzI2VDA5NTAzMlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWVkNmIzNGY0ZTczMWFiMjIzN2ZiMjMxMTRjNzhkNGRmODEwODExZjU3MzY5M2NjNjY1MWE3YWQ1YWQ5OGE1NzgmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.WAA_hEOgMQygDBYtfeFGhr2eX3NqhWbsOcKR5DdGW80)

### 2.Vulnerability code audit

The vulnerability appears in the background template management page:
[![image](https://private-user-images.githubusercontent.com/34084717/290614027-431f1d9d-c57a-4a64-bc9b-265fff8e5323.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MTE0NDY5MzIsIm5iZiI6MTcxMTQ0NjYzMiwicGF0aCI6Ii8zNDA4NDcxNy8yOTA2MTQwMjctNDMxZjFkOWQtYzU3YS00YTY0LWJjOWItMjY1ZmZmOGU1MzIzLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDAzMjYlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwMzI2VDA5NTAzMlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTUwMDFmOTYyZmNiODYxMTkwOWQyMWEwYTUzM2I5NmNhZWRiOTQ5NDQ3NGFmZDVkNzcxNzFjZTJiOWJlNjliMGUmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.Dv17xLDYLUkUiUNzOQUiw4O5K1JGUy0cSfikIaH9vNs)](https://private-user-images.githubusercontent.com/34084717/290614027-431f1d9d-c57a-4a64-bc9b-265fff8e5323.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MTE0NDY5MzIsIm5iZiI6MTcxMTQ0NjYzMiwicGF0aCI6Ii8zNDA4NDcxNy8yOTA2MTQwMjctNDMxZjFkOWQtYzU3YS00YTY0LWJjOWItMjY1ZmZmOGU1MzIzLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDAzMjYlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwMzI2VDA5NTAzMlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTUwMDFmOTYyZmNiODYxMTkwOWQyMWEwYTUzM2I5NmNhZWRiOTQ5NDQ3NGFmZDVkNzcxNzFjZTJiOWJlNjliMGUmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.Dv17xLDYLUkUiUNzOQUiw4O5K1JGUy0cSfikIaH9vNs)
Audit the page source /views/admin/tpl_add.html file, see the filename received by filename file content received by content, and then pass the data to the POST. s=Admin/Tpl/Update page processing:
[![image](https://private-user-images.githubusercontent.com/34084717/290614113-349871c9-d86a-4932-91e1-d4fa2c52b6cc.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MTE0NDY5MzIsIm5iZiI6MTcxMTQ0NjYzMiwicGF0aCI6Ii8zNDA4NDcxNy8yOTA2MTQxMTMtMzQ5ODcxYzktZDg2YS00OTMyLTkxZTEtZDRmYTJjNTJiNmNjLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDAzMjYlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwMzI2VDA5NTAzMlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWI0YTI1NmFhNjk2NmI3MzZmNWJlZjYwOTdlYTlmNDYxNzViZTZjODlkOTQ1MWUwOWEyZGRkMmNlNzJkMzc2YzImWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.XmibC2f08glTB4L4OHCRCFnPNvRCmbUkbkFIc2AhVPg)](https://private-user-images.githubusercontent.com/34084717/290614113-349871c9-d86a-4932-91e1-d4fa2c52b6cc.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MTE0NDY5MzIsIm5iZiI6MTcxMTQ0NjYzMiwicGF0aCI6Ii8zNDA4NDcxNy8yOTA2MTQxMTMtMzQ5ODcxYzktZDg2YS00OTMyLTkxZTEtZDRmYTJjNTJiNmNjLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDAzMjYlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwMzI2VDA5NTAzMlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWI0YTI1NmFhNjk2NmI3MzZmNWJlZjYwOTdlYTlmNDYxNzViZTZjODlkOTQ1MWUwOWEyZGRkMmNlNzJkMzc2YzImWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.XmibC2f08glTB4L4OHCRCFnPNvRCmbUkbkFIc2AhVPg)
Track them down? S = Admin/Tpl/Update page source/core/Lib/Action/Admin/TplAction class. PHP file, see the Update function to receive the filename and the content variables, only after receiving the two variables for judging whether it is empty, The file name and file contents are not detected with dangerous characters, and data is directly written to the file using the write_file function, which means that there is any file upload vulnerability.
[![image](https://private-user-images.githubusercontent.com/34084717/290614176-be331862-913b-4a6a-add9-7808c162a90b.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MTE0NDY5MzIsIm5iZiI6MTcxMTQ0NjYzMiwicGF0aCI6Ii8zNDA4NDcxNy8yOTA2MTQxNzYtYmUzMzE4NjItOTEzYi00YTZhLWFkZDktNzgwOGMxNjJhOTBiLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDAzMjYlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwMzI2VDA5NTAzMlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTRkZTgwMGFiZmIwOTAwMDg1ZTg1ODU0YTgwNzE5ZWIxMjFhMTRmOWY0NGE5NWY4NDRlODI1NTEyZGQ1OGU5YTEmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.P3Iz-nJWcfKOrSPH3ZLYDOrD9mQEL96U-uZlc8kbbg8)](https://private-user-images.githubusercontent.com/34084717/290614176-be331862-913b-4a6a-add9-7808c162a90b.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MTE0NDY5MzIsIm5iZiI6MTcxMTQ0NjYzMiwicGF0aCI6Ii8zNDA4NDcxNy8yOTA2MTQxNzYtYmUzMzE4NjItOTEzYi00YTZhLWFkZDktNzgwOGMxNjJhOTBiLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDAzMjYlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwMzI2VDA5NTAzMlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTRkZTgwMGFiZmIwOTAwMDg1ZTg1ODU0YTgwNzE5ZWIxMjFhMTRmOWY0NGE5NWY4NDRlODI1NTEyZGQ1OGU5YTEmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.P3Iz-nJWcfKOrSPH3ZLYDOrD9mQEL96U-uZlc8kbbg8)

### 3.Exploit the vulnerability

Log in to the background of the target website through admin default password admin888 or password blasting or even phishing, click template management to enter the /template/default/Home directory, select any file and click edit:
[![image](images/290614264-71077d0b-f73a-4974-a358-3fd925514942.png)](https://private-user-images.githubusercontent.com/34084717/290614264-71077d0b-f73a-4974-a358-3fd925514942.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MTE0NDY5MzIsIm5iZiI6MTcxMTQ0NjYzMiwicGF0aCI6Ii8zNDA4NDcxNy8yOTA2MTQyNjQtNzEwNzdkMGItZjczYS00OTc0LWEzNTgtM2ZkOTI1NTE0OTQyLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDAzMjYlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwMzI2VDA5NTAzMlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWI1NjBkOTU4MTIzMzk4YjIxOWY0M2I0YzQ5MmQwOGI4MzY3OGZhNzZmMDNjMWQ1MmU5MTY0OTIxMDk2N2I0NzUmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.OBBSTaihmFtKeqSHxKnJAtl3efr5XIv3c8w7vHoPlNk)
Enter the editing page, enter the php test code in the file content form, start BurpSuite tool to capture the package, and click Submit:
[![image](images/290614355-1a1d9a49-b874-438e-91f2-e7771d88a2af.png)](https://private-user-images.githubusercontent.com/34084717/290614355-1a1d9a49-b874-438e-91f2-e7771d88a2af.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MTE0NDY5MzIsIm5iZiI6MTcxMTQ0NjYzMiwicGF0aCI6Ii8zNDA4NDcxNy8yOTA2MTQzNTUtMWExZDlhNDktYjg3NC00MzhlLTkxZjItZTc3NzFkODhhMmFmLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDAzMjYlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwMzI2VDA5NTAzMlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTM2MjcyNzFmODlkM2U0MDM0ZWI2MDkxYzU2YTUxNWY3NWNjMmRlZTZkN2VjYTMwYmIyZTI5M2FjMzU4MTcwNGEmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.s_j0z1063Z0PW2_kco9Rf9MIsFnEhlaN1pmA4dchZ9I)
BurpSuite after catching the package, change the filename suffix to php, and then click Put package:
[![image](images/290614427-6da3349a-cef4-4243-b4be-e864dd77a123.png)](https://private-user-images.githubusercontent.com/34084717/290614427-6da3349a-cef4-4243-b4be-e864dd77a123.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MTE0NDY5MzIsIm5iZiI6MTcxMTQ0NjYzMiwicGF0aCI6Ii8zNDA4NDcxNy8yOTA2MTQ0MjctNmRhMzM0OWEtY2VmNC00MjQzLWI0YmUtZTg2NGRkNzdhMTIzLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDAzMjYlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwMzI2VDA5NTAzMlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTljZDk0Y2MwYTM3ZjEyZGMzNzQ2YTZkYjUwNGVkMjk3YjIyOTczZTAyMjA4NmYwZDc4MTgwZDA1ZDE0ZmQxMTYmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.m-2T7h2YrBHtKXaKx29ypD7UagA44pmjCniZho0rW8o)
Back to the background website template management, see the successful creation of my_hot_info.php file, visit the file page to see the successful execution of php test code:
[![image](images/290614525-a3cc19a0-5288-41f4-900a-6690e62c7a90.png)](https://private-user-images.githubusercontent.com/34084717/290614525-a3cc19a0-5288-41f4-900a-6690e62c7a90.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MTE0NDY5MzIsIm5iZiI6MTcxMTQ0NjYzMiwicGF0aCI6Ii8zNDA4NDcxNy8yOTA2MTQ1MjUtYTNjYzE5YTAtNTI4OC00MWY0LTkwMGEtNjY5MGU2MmM3YTkwLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDAzMjYlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwMzI2VDA5NTAzMlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWE3ZjZmODQ1ZGJjNmYzNjNiZjk0NmYzYWE1Njk4ZjNjY2QyYjIwOGRiNTc2MjFmODJkNGVkMWI4MWI5NDliOWEmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0.Qg81jr1gGClB5GKIE3JBw6g-VOq6N1IAaK4Q8kI1Gso)
[![image](images/290614556-e29c60a1-2382-4d9c-b2e7-d9b468cfe1fe.png)](https://private-user-images.githubusercontent.com/34084717/290614556-e29c60a1-2382-4d9c-b2e7-d9b468cfe1fe.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MTE0NDY5MzIsIm5iZiI6MTcxMTQ0NjYzMiwicGF0aCI6Ii8zNDA4NDcxNy8yOTA2MTQ1NTYtZTI5YzYwYTEtMjM4Mi00ZDljLWIyZTctZDliNDY4Y2ZlMWZlLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDAzMjYlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQwMzI2VDA5NTAzMlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTA4YzkwYjM4MWNjZDczOGQ0ZDNiNjcxZDg2N2Q1N2FmMWVkMmQ1NTc2MWU0Y2YxMGY0MzVlYmQ0NzBmMjE5NTYmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0JmFjdG9yX2lkPTAma2V5X2lkPTAmcmVwb19pZD0wIn0._z39_H0vweufHL-RfKCHiRQQiwnB4Xa_ekNVUR4Umd0)